{% extends "layout.html.j2" %} 
{% block title %} üêï &nbsp; DoggyDex {% endblock %} 
{% block content %}
<div class="container my-5">
    <div class="row justify-content-center">
        <div class="col-md-10 col-lg-8">
            <div class="main-container p-5 text-center fade-in">
                <div class="mb-4">
                    <h1 class="display-4 mb-3">Welcome to DoggyDex üêæ</h1>
                    <p class="lead mb-4">Discover your dog's breed with our AI-powered identification system!</p>
                    <div class="row text-center mb-4">
                        <div class="col-md-4 mb-3">
                            <i class="fas fa-camera fa-2x text-warning mb-2"></i>
                            <h6>Upload Photo</h6>
                            <small class="text-muted">Choose a clear photo of your dog</small>
                        </div>
                        <div class="col-md-4 mb-3">
                            <i class="fas fa-brain fa-2x text-info mb-2"></i>
                            <h6>AI Analysis</h6>
                            <small class="text-muted">Our model analyzes the image</small>
                        </div>
                        <div class="col-md-4 mb-3">
                            <i class="fas fa-dog fa-2x text-success mb-2"></i>
                            <h6>Get Results</h6>
                            <small class="text-muted">Discover the breed with confidence levels</small>
                        </div>
                    </div>
                </div>

                <form id="uploadForm" action="/" method="post" enctype="multipart/form-data">
                    <div class="mb-4">
                        <label for="fileInput" class="form-label h5">Choose your dog photo:</label>
                        <input 
                            type="file" 
                            name="file" 
                            id="fileInput"
                            accept="image/*" 
                            class="form-control form-control-lg"
                            required
                        >
                        <div id="filePreview" class="mt-3" style="display: none;">
                            <img id="previewImage" class="img-fluid rounded" style="max-height: 200px;">
                            <p id="fileName" class="mt-2 text-muted"></p>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary btn-lg px-5">
                        <i class="fas fa-search me-2"></i> Identify Breed
                    </button>
                </form>

                <!-- Loading Spinner -->
                <div id="loadingSpinner" class="loading-container mt-4 bounce-in" style="display: none;">
                    <img src="{{ url_for('static', filename='spinner.gif') }}" alt="Loading..." height="80">
                    <h5 class="mt-3 text-primary">Sniffing out the breed...</h5>
                    <p class="text-muted">Our AI is analyzing your dog's features</p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const fileInput = document.getElementById('fileInput');
    const form = document.getElementById('uploadForm');
    const spinner = document.getElementById('loadingSpinner');
    const filePreview = document.getElementById('filePreview');
    const previewImage = document.getElementById('previewImage');
    const fileName = document.getElementById('fileName');

    // File input change
    fileInput.addEventListener('change', (e) => {
        if (e.target.files.length > 0) {
            handleFileSelect(e.target.files[0]);
        }
    });

    // Handle file selection
    function handleFileSelect(file) {
        if (file.type.startsWith('image/')) {
            const reader = new FileReader();
            reader.onload = (e) => {
                previewImage.src = e.target.result;
                fileName.textContent = file.name;
                filePreview.style.display = 'block';
            };
            reader.readAsDataURL(file);
        }
    }

    // Form submission
    form.addEventListener('submit', () => {
        form.style.display = 'none';
        spinner.style.display = 'block';
    });
</script>
{% endblock %}
